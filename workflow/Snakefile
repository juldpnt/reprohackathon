# Here we define the accessions to be used in the analysis
# Un/comment the lines below to change the number of accessions to be downloaded
SAMPLES = [
            "SRR10379721",
            # "SRR10379722",
            # "SRR10379723",
            # "SRR10379724",
            # "SRR10379725",
            # "SRR10379726"
            ]

# -------- Target rules
# This rule will change after each next step in the project is reached
rule all:
    """
    Target rule, the input is the output of the DAG made by snakemake
    """
    input:
        expand("tmp/trimmed_fastq/{sample}_trimmed.fastq", sample=SAMPLES)

# -------- Part 1: Download the accession files
rule get_fastq_files:
    output:
        fastq="tmp/raw_fastq/{sample}.fastq"
    container: 
        "docker://juldpnt/reprohackaton_8:sratoolkit" 
    shell:
        # """
        # fasterq-dump --threads 4 --progress {wildcards.sample} > {output.fastq}
        # """
        # Uncomment the lines below to download only 1000 reads per accession and comment the lines above
        """
        fastq-dump --stdout -X 1000 {wildcards.sample} > {output.fastq}
        """
rule trimming:
    input:
        fastq="tmp/raw_fastq/{sample}.fastq"
    output:
        trimmed="tmp/trimmed_fastq/{sample}_trimmed.fastq"
    container:
        "docker://vibsinglecellnf/trimgalore:trimgalore-0.6.7-cutadapt-4.2"
    shell:
        """
        trim_galore -q 20 --phred33 --length 25 {input.fastq} > {output.trimmed}
        """