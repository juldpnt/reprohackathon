---
title: "DeSeq"
output: html_document
---

```{r setup, include=FALSE}
library("DESeq2")

# Création d'un objet DESeqDataSet (dds) avec la matrice et les données de colonnes
library("data.table")

subreadCounts <- read.delim("counts_aur.txt",header=TRUE,sep="\t",row.names="Geneid")

setDT(subreadCounts)

subreadCounts <- as.matrix(subreadCounts)

subreadCounts <- subreadCounts[,-c(2,3,4,5,6)]

for (i in (1:2967)){
  for (j in (2:7)){
    subreadCounts[i,j] <- strtoi(gsub(' ','',subreadCounts[i,j]))
  }
 
}
  

subreadData <- read.delim("coldata_aur.txt")

head(subreadCounts)

dataSet <- DESeqDataSetFromMatrix(countData = subreadCounts, colData = subreadData, design = ~ condition)

```

```{r}
# analyse d'expression différentielle sur notre dds

dataSet <- DESeq(dataSet)
```

```{r}
# formatage des résultats sous forme de DataFrame

resultats <- results(notresetdedonnees)
```

```{r}
# exportation des résultats sous forme de MA-plot

plotMA(resultats, ylim = "c(limite inférieure du log fold change à afficher, limite supérieure)")
```
